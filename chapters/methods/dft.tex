\section{Quantum Calculations}
\label{sec:methods-QM}

With increased computing power and, in particular, advances in parallel algortims, it is now possible to calculate a range of physical properties for materials on the atomic level without the use of any experimental parameters.
Such \textit{ab initio} (from the beginning) methods ...
\expand

\subsection{The Electronic Structure Problem}
The Schr\"odinger equation is the quantum analoge of Newton's equations of motion and thus governs the motions of the quantum system in question as well as its observables.
\expand

The Born-Oppenheimer approximation (\fref{sec:born-oppenheimer}) allows the separation of the Hamiltonian to an electronic part and a nuclear part.
Thus, the positions of the nucleii, $\vR_I$ only enter the calculations as parameters.
A full quantum treatment will not be discussed here.
\expand

A non-relativistic system of $N$ electrons (and $N_I$ nuclei) is described by the time independant Schr\"odinger equation,
\beq{schrodinger-basic}
 \widehat{H}\Psi = E\Psi,
\eeq
where $\Psi \equiv \Psi(\vr_1, \vr_2, \ldots ,\vr_N)$ is the wave function, depending on the spatial coordinates, $\vr_i$, of each electron, $E$ is the electronic energy of the system and $\widehat{H}$ is the hamiltonian,
\beq{hamiltonian}
\widehat{H} = -\sum_i^N \frac{\nabla^2_i}{2} - \sum_i^N \sum_{j>i}^N \frac{1}{\left| \vr_i - \vr_j \right|} - \sum_i^N \sum_I^{N_I} \frac{1}{\left| \vr_i - \vR_I \right|} + V_\text{env},
\eeq
which consists of 4 terms.
First there is the kinetic energy of the electrons, then the electron-electron interaction, followed by the electron-nuclei interaction and finally any further environmental influence (e.g. an applied electric field) is represented by a single term.
The last two terms are often bundled into a single external term,
\beq{hamiltonian-external}
V_\text{ext} = \sum_i^N \sum_I^{N_I} \frac{1}{\left| \vr_i - \vR_I \right|} + V_\text{env}.
\eeq

Though it may look innocent, solving the Schr\"odinger equation, which is a second order partial derivative problem \tred{(is this correct?)}, is a daunting task and in most cases significant approximations must be made.
In particular, storing the wavefunction of a large system requires more data capacity than practical. \expand

\subsection{Density Functional Theory}
\label{sec:methods-dft}
One of the most popular and common teqchniques for solving the electronic structure problem is the Density Functional Theory (DFT) which can, from first principles (\textit{ab initio}), exactly (in theory) solve the Schr\"odinger equation.
However, in practice, approximations must be made for all but the most simple systems.
Nevertheless, DFT has produced many interesting and good results and is now a well established formalism that is continually being reviewed and improved.
Furthermore, the \textit{ab initio} nature of DFT makes it a great companion to experimental research, not only for comparison and prediction of interesting materials but also to assist and expand upon data analysis.

The success of DFT has yielded one of its founders, Walter Kohn, one half of the Nobel Prize in chemistry in 1998, for the development of the density functional theory~\cite{kohn1999} along with John Pople for his development of computational methods in quantum chemistry~\cite{pople1999}.

\subsubsection{The Hohenberg-Kohn Theorem}
The origin \tblue{(What about the Thomas-Fermi model)} of DFT lies in the Hohnberg-Kohn theorem, which reformulates the electronic structure problem to depend on the $3$ dimensional, ground state, electron density, $\rho(\vr)$, instead of the $3N$ dimensional wavefunction, $\Psi(\vr_1, \vr_2, \ldots, \vr_N)$.
According to the first Hohenberg-Kohn theorem~\cite{hohenberg-kohn-1964}, any external term, $V_\text{ext}$, in \fref{eq:hamiltonian} yields a different electron density from any non-identical, up to a constant, $V'_\text{ext}$.
In other words: there is a one-to-one correspondence between the wavefunction and the electron density of the ground state and all observables that depend on the wavefunction can, thus, be extracted from the ground state density.
Furthermore, the second Hohenberg-Kohn theorem~\cite{hohenberg-kohn-1964} adds a variational way to discover the true ground state density and thus ground state energy, $E_0$.

A re-formulation of the Schrodinger equation, shows the energy as a functional of the electron density, $E[\rho(\vr)] = \bra a |b | c \ket$\expand

\tred{Revised until here}

Once this has been established, it is simple to see that the total energy is a unique functional of the electron density, $\rho(\textbf{r})$, which is an observable while the wavefunction is not,
\begin{equation}
\label{eq:H-KenergyDensity}
 E[\rho] = \langle \Psi[\rho] | \widehat{H} | \Psi[\rho] \rangle.
\end{equation}
The Raleigh-Ritz variational principle is used to minimize the energy and find the ground state and density, %[missing ref]
\begin{equation}
 E_{0} = \min_{\rho(\mathbf{r})} \left(E[\rho(\mathbf{r})] \right).
\label{eq:H-Kvariational}
\end{equation}
This is the basis of DFT, developed by Hohenberg and Kohn \cite{hohenberg1964} in 1964.

\bit
\item The earliest mention of DFT type calculations were made by Thomas~\citemiss and Fermi~\citemiss.
\eit

\subsubsection{The Kohn-Sham Equations}
Currently there is no known way to perform the one-to-one mapping suggested by the H-K theorem. However in 1965 Kohn and Sham (K-S) published an indirect approach for calculating the energy functional $E[\rho]$ \cite{kohn1965}.
They showed that the interacting many-electron system can be mapped, approximately, onto a non-interacting system of single electron states, $\{\phi_i\}$, where each electron is subject to the effective potential $v_{eff}(\vect{r})$ due to all other particles. These one electron wavefunctions can be produced by solving the K-S equations,
\begin{equation}
\label{eq:K-Sequation}
 \left\{-\frac{1}{2} \nabla ^2 + v_\mathrm{eff}(\vect{r}) \right\} \phi_i(\vect{r}) = \epsilon_i \phi_i(\vect{r}).
\end{equation}
Since both the effective potential and the wavefunctions are unknown these equations must be solved self-consistently.
The electron density can then be produced using the square of the wavefunctions,
\begin{equation}
\label{eq:electronDensity}
 \rho(\vect{r}) = \sum_{i=1}^N \left| \phi_i(\vect{r}) \right|^2.
\end{equation}
The effective potential can be written as
\begin{equation}
\label{eq:effectivePotential}
 v_\mathrm{eff}(\vect{r}) = v(\vect{r}) + v_{H}(\vect{r}) + v_{XC}(\vect{r})
\end{equation}
where $v(\vect{r})$ is the sum of the potential due to the kinetic and ionic parts in equation \ref{eq:generalHamiltonian}%[Is this correct and do I need to include this reference]
, $v_{H}(\vect{r})$ is the Hartree potential,
\begin{equation}
\label{eq:hartreePotential}
 v_{H}(\vect{r}) = \int d^3r \frac{\rho(\vect{r'})}{\left| \vect{r} - \vect{r} \right|},
\end{equation}
and
\begin{equation}
\label{eq:XCpotential}
 v_{XC}(\vect{r}) = \frac{\delta E_{XC}[\rho]}{\delta \rho(\vect{r})}
\end{equation}
is the potential due to the exchange-correlation functional, $E_{XC}[\rho]$, which will be discussed in section \ref{sec:XCfunctional} 

\subsubsection{The Exchange-Correlation Functional}
\label{sec:XCfunctional}
The Kohn-Sham equations are in principle exact, however the exchange-correlation functional, $E_{XC}[\rho]$, is generally not known and has to be approximated. The accuracy of the approximation becomes a major issue in solving the Kohn-Sham equations.

The exchange-correlation functional is a local functional which describes the electron-electron interaction,
\begin{equation}
\label{eq:XCfunctional}
 E_{XC}[\rho] = \int d^3r\, \epsilon_{XC}(\rho, \vect{r})\rho(\vect{r})
\end{equation}
where $\epsilon_{XC}(\rho, \vect{r})$ is the exchange-correlation energy density.

The approximations used in our work are based on the so-called Generalized Gradient Approach (GGA). The GGA uses the the exchange-correlation energy of a homogeneous electron gas at point $\vect{r}$ like the Local Density Approximation (LDA) \cite{kohn1965} but also uses the gradient of the density to account for inhomogeneity. This, however, is not a good choice by itself so a reduced density gradient, $s(\vect{r})$, is used, as suggested by Langreth and Perdew \cite{langreth1977}. The exchange-correlation functional then becomes
\begin{equation}
  E_{XC}^{GGA}[\rho] = \int d^3r\, \epsilon_{XC}^{GGA}(\rho(\vect{r}), s(\vect{r}))\rho(\vect{r})
\end{equation}
with
\begin{equation}
\label{eq:GGAreducedDensityGradient}
 s(\vect{r}) = \frac{\left|\nabla \rho(\vect{r})\right|}{2\sqrt[3]{3\pi^2\rho(\vect{r})} \rho(\vect{r})}.
\end{equation}
%The calculations in chapter \ref{ch:japan} use GGA based on the PBE functional \cite{perdew1996} while the calculations in chapter \ref{ch:dacapo} use GGA based on the RPBE functional \cite{hammer1999}.

\subsection{Implementation of DFT}
\label{sec:methods-dft-implemetnation}

\subsubsection{The Plane Wave Basis Set}
In implementing DFT calculations, the Kohn-Sham wavefunctions are expanded in a particular basis set. In our work plane waves are used under periodic boundary conditions in accordance with Bloch's theorem,
\begin{equation}
\label{eq:blochsTherom}
 \psi_\vect{k}^{m}(\vect{r}) = \sum_\vect{G}c_{\vect{k} + \vect{G}}^m\, e^{i(\vect{k}+\vect{G})\cdot\vect{r}}
\end{equation}
where $\vect{G}$ are the reciprocal lattice vectors. %[what are $c_{\vect{k} + \vect{G}}^m$?]. 
For an exact solution, an infinite number of plane waves is needed. Fortunately the plane waves at the lower end of the kinetic energy range are the most important, so the number of plane waves can be reduced by defining a cutoff, $G_{cut}$, where the solution becomes good enough:
\begin{equation}
 \left( \frac{\hbar^2}{2m} \right) \left| \vect{k} + \vect{G}_{cut} \right|^2 \le E_\mathrm{cut}.
\end{equation}
This leads to one of the main advantages of plane waves. By increasing the cutoff the accuracy of the calculation can be systematically increased. 

A disadvantage of plane waves is their inefficiency to deal with high curvature regions, such as the atomic core. To overcome this pseudopotentials can be used. In the core, pseudopotentials are an average of the potential due to the core electrons and the nucleus felt by the valence electrons inside a given sphere but outside the sphere the pseudopotential becomes identical to the all-electron potential. The plane-wave cutoff can be lowered even further when using pseudopotentials while generally giving results of good accuracy, especially the so-called ultrasoft pseudopotential with non-local components \cite{vanderbilt1990}.
